Args:
	algorithm: Union
	beta: 0.001
	checkpoint_freq: None
	data_dir: data
	dataset: RotatedMNIST
	fd: 60
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: output/mnist_tests/union_fd60_b0.001
	seed: 0
	steps: None
	test_envs: [0]
	trial_seed: 0
HParams:
	batch_size: 256
	beta: 0.001
	class_balanced: True
	decay: 1500
	fd: 60
	groupdro_eta: 0.01
	irm_lambda: 100.0
	irm_penalty_anneal_iters: 500
	lr: 0.001
	mixup_alpha: 0.2
	mldg_beta: 1.0
	mlp_depth: 3
	mlp_dropout: 0.0
	mlp_width: 256
	mmd_gamma: 1.0
	n_comp: 6
	resnet_dropout: 0.0
	weight_decay: 0.0
Args:
	algorithm: Union
	beta: 0.001
	checkpoint_freq: None
	data_dir: data
	dataset: RotatedMNIST
	fd: 60
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: output/mnist_tests/union_fd60_b0.001
	seed: 0
	steps: None
	test_envs: [0]
	trial_seed: 0
HParams:
	batch_size: 256
	beta: 0.001
	class_balanced: True
	decay: 1500
	fd: 60
	groupdro_eta: 0.01
	irm_lambda: 100.0
	irm_penalty_anneal_iters: 500
	lr: 0.001
	mixup_alpha: 0.2
	mldg_beta: 1.0
	mlp_depth: 3
	mlp_dropout: 0.0
	mlp_width: 256
	mmd_gamma: 1.0
	n_comp: 6
	resnet_dropout: 0.0
	weight_decay: 0.0
saved at step 0
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  epoch         loss1         loss2         step          step_time    
0.3162631241  0.3116159451  0.3750803514  0.3626232319  0.3847225198  0.3784826404  0.3874008999  0.3904843549  0.3579770706  0.3673381912  0.3276545591  0.3330475782  0.0000000000  -2.637556552  -2.208298206  0             36.023513317 
saved at step 100
0.8793657596  0.8714102015  0.9627169488  0.9605657951  0.9746089565  0.9717102443  0.9792157703  0.9759965709  0.9744990893  0.9691384483  0.9632486875  0.9661380197  100.00000000  -12.39748088  -12.32429884  100           5.5105704451 
saved at step 200
0.9326119563  0.9271324475  0.9783586887  0.9772824689  0.9817870152  0.9794256322  0.9855367474  0.9832833262  0.9827493839  0.9785683669  0.9792135433  0.9811401629  200.00000000  -17.17068362  -17.25243893  200           4.8361494899 
saved at step 300
0.9441825584  0.9408486927  0.9845725305  0.9811401629  0.9883222627  0.9854264895  0.9880008571  0.9884269181  0.9862852245  0.9832833262  0.9828565306  0.9849978568  300.00000000  -18.87525230  -18.83596504  300           5.9927791023 
saved at step 400
0.9538247268  0.9494213459  0.9876794515  0.9858551222  0.9891793443  0.9888555508  0.9892864795  0.9875696528  0.9871423979  0.9854264895  0.9839279974  0.9841405915  400.00000000  -19.77831758  -19.70925670  400           4.5771767926 
saved at step 500
0.9557531605  0.9549935705  0.9895007499  0.9862837548  0.9921791301  0.9888555508  0.9912149132  0.9905700814  0.9890710383  0.9871410201  0.9875709847  0.9875696528  500.00000000  -20.42381784  -20.37628147  500           5.6720255756 
saved at step 600
0.9602528391  0.9622803258  0.9916434540  0.9879982855  0.9931433469  0.9905700814  0.9917505892  0.9927132447  0.9911068252  0.9879982855  0.9897139184  0.9884269181  600.00000000  -20.83967252  -20.86598192  600           6.2864653420 
saved at step 700
0.9588600814  0.9575653665  0.9925005357  0.9888555508  0.9937861581  0.9901414488  0.9931433469  0.9939991427  0.9924997321  0.9884269181  0.9911068252  0.9905700814  700.00000000  -21.19524866  -21.25747005  700           4.5734644818 
saved at step 800
0.9647525177  0.9644234891  0.9942146990  0.9892841835  0.9946432398  0.9918559794  0.9927148061  0.9939991427  0.9927140255  0.9884269181  0.9916425587  0.9897128161  800.00000000  -21.46649475  -21.52863510  800           6.2793221831 
saved at step 900
0.9642168417  0.9635662237  0.9950717806  0.9892841835  0.9952860510  0.9918559794  0.9947503750  0.9952850407  0.9938926390  0.9901414488  0.9933569056  0.9901414488  900.00000000  -21.69097564  -21.73989496  900           5.7823788595 
0.9695736019  0.9699957137  0.9956074566  0.9879982855  0.9948575102  0.9918559794  0.9950717806  0.9939991427  0.9944283724  0.9888555508  0.9945355191  0.9914273468  1000.0000000  -21.88444469  -21.95041927  1000          4.3410214639 
0.9644311121  0.9657093871  0.9963574030  0.9901414488  0.9956074566  0.9918559794  0.9950717806  0.9952850407  0.9952855459  0.9879982855  0.9948569592  0.9901414488  1100.0000000  -22.02556613  -22.08740737  1100          6.1166689062 
0.9668952218  0.9669952850  0.9964645382  0.9892841835  0.9961431326  0.9922846121  0.9955003214  0.9944277754  0.9956069860  0.9879982855  0.9954998393  0.9909987141  1200.0000000  -22.16913513  -22.27647405  1200          5.1101199389 
saved at step 1300
0.9685022498  0.9678525504  0.9964645382  0.9909987141  0.9963574030  0.9922846121  0.9960359974  0.9952850407  0.9956069860  0.9871410201  0.9968927462  0.9918559794  1300.0000000  -22.27949272  -22.34574066  1300          5.0238740039 
0.9728947932  0.9734247750  0.9967859439  0.9901414488  0.9967859439  0.9914273468  0.9961431326  0.9948564081  0.9956069860  0.9888555508  0.9971070395  0.9909987141  1400.0000000  -22.38661222  -22.45267576  1400          6.1399805975 
saved at step 1500
0.9685022498  0.9678525504  0.9967859439  0.9897128161  0.9967859439  0.9914273468  0.9963574030  0.9952850407  0.9962498661  0.9888555508  0.9972141862  0.9922846121  1500.0000000  -22.48843843  -22.55164110  1500          4.5698258901 
saved at step 1600
0.9706449539  0.9699957137  0.9968930791  0.9897128161  0.9970002143  0.9922846121  0.9964645382  0.9948564081  0.9963570128  0.9897128161  0.9976427730  0.9931418774  1600.0000000  -22.68121986  -22.75720813  1600          5.8761240578 
0.9702164131  0.9687098157  0.9974287551  0.9888555508  0.9970002143  0.9909987141  0.9967859439  0.9948564081  0.9968927462  0.9901414488  0.9978570663  0.9922846121  1700.0000000  -22.71472291  -22.78231781  1700          6.3156951356 
saved at step 1800
0.9710734948  0.9704243463  0.9977501607  0.9901414488  0.9971073495  0.9914273468  0.9967859439  0.9952850407  0.9969998929  0.9892841835  0.9981785064  0.9935705101  1800.0000000  -22.74894855  -22.81207639  1800          4.5898372531 
0.9708592243  0.9695670810  0.9977501607  0.9892841835  0.9973216199  0.9918559794  0.9975358903  0.9948564081  0.9971070395  0.9884269181  0.9984999464  0.9922846121  1900.0000000  -22.76352104  -22.82256090  1900          6.3289297342 
saved at step 2000
0.9708592243  0.9699957137  0.9979644311  0.9897128161  0.9975358903  0.9914273468  0.9978572959  0.9952850407  0.9974284796  0.9905700814  0.9986070931  0.9939991427  2000.0000000  -22.81525283  -22.86776422  2000          6.4854718924 
saved at step 2100
0.9734304693  0.9717102443  0.9980715663  0.9897128161  0.9977501607  0.9927132447  0.9979644311  0.9952850407  0.9974284796  0.9901414488  0.9986070931  0.9931418774  2100.0000000  -22.81794116  -22.89118873  2100          5.8258296561 
0.9711806300  0.9695670810  0.9983929719  0.9892841835  0.9982858367  0.9927132447  0.9981787015  0.9957136734  0.9977499196  0.9901414488  0.9986070931  0.9927132447  2200.0000000  -22.84144742  -22.90575714  2200          6.4908954930 
0.9690379259  0.9665666524  0.9981787015  0.9884269181  0.9983929719  0.9931418774  0.9982858367  0.9952850407  0.9979642130  0.9892841835  0.9987142398  0.9931418774  2300.0000000  -22.86357851  -22.92126438  2300          7.3018985581 
saved at step 2400
0.9697878723  0.9665666524  0.9986072423  0.9888555508  0.9986072423  0.9931418774  0.9986072423  0.9961423060  0.9982856531  0.9901414488  0.9987142398  0.9931418774  2400.0000000  -22.88755147  -22.93992605  2400          6.7912768459 
saved at step 2500
0.9716091708  0.9678525504  0.9986072423  0.9909987141  0.9991429184  0.9935705101  0.9987143775  0.9948564081  0.9984999464  0.9897128161  0.9988213865  0.9931418774  2500.0000000  -22.91019830  -22.96216205  2500          5.3456672287 
0.9703235483  0.9665666524  0.9988215127  0.9888555508  0.9994643240  0.9931418774  0.9988215127  0.9957136734  0.9986070931  0.9901414488  0.9990356798  0.9931418774  2600.0000000  -22.93381450  -22.97877416  2600          6.0973024917 
0.9708592243  0.9652807544  0.9991429184  0.9897128161  0.9995714592  0.9927132447  0.9990357832  0.9948564081  0.9987142398  0.9901414488  0.9990356798  0.9935705101  2700.0000000  -22.95509185  -22.98816658  2700          6.7897136283 
saved at step 2800
0.9725733876  0.9699957137  0.9990357832  0.9905700814  0.9995714592  0.9931418774  0.9992500536  0.9961423060  0.9986070931  0.9905700814  0.9989285332  0.9918559794  2800.0000000  -22.97064651  -23.00369737  2800          5.0470835781 
saved at step 2900
0.9701092779  0.9665666524  0.9991429184  0.9884269181  0.9995714592  0.9944277754  0.9992500536  0.9961423060  0.9986070931  0.9909987141  0.9989285332  0.9922846121  2900.0000000  -22.98931539  -23.02188291  2900          5.8913310266 
saved at step 3000
0.9728947932  0.9695670810  0.9992500536  0.9909987141  0.9995714592  0.9935705101  0.9993571888  0.9969995714  0.9987142398  0.9905700814  0.9989285332  0.9918559794  3000.0000000  -22.99035917  -23.02965835  3000          6.7692756152 
0.9717163060  0.9674239177  0.9992500536  0.9888555508  0.9994643240  0.9935705101  0.9995714592  0.9965709387  0.9988213865  0.9901414488  0.9991428265  0.9927132447  3100.0000000  -23.06997552  -23.10419925  3100          6.1952103567 
0.9723591172  0.9678525504  0.9992500536  0.9892841835  0.9996785944  0.9944277754  0.9995714592  0.9965709387  0.9988213865  0.9901414488  0.9991428265  0.9922846121  3200.0000000  -23.10236499  -23.13378873  3200          6.1207199740 
0.9739661453  0.9691384483  0.9992500536  0.9905700814  0.9997857296  0.9931418774  0.9995714592  0.9961423060  0.9988213865  0.9897128161  0.9990356798  0.9918559794  3300.0000000  -23.09669315  -23.12448734  3300          6.8157127476 
saved at step 3400
0.9711806300  0.9665666524  0.9993571888  0.9901414488  0.9997857296  0.9944277754  0.9994643240  0.9965709387  0.9987142398  0.9901414488  0.9991428265  0.9927132447  3400.0000000  -23.10114421  -23.13636573  3400          7.0759356976 
0.9707520891  0.9695670810  0.9993571888  0.9892841835  0.9997857296  0.9939991427  0.9995714592  0.9965709387  0.9988213865  0.9909987141  0.9990356798  0.9927132447  3500.0000000  -23.10102434  -23.12860656  3500          6.3068157792 
0.9728947932  0.9691384483  0.9995714592  0.9884269181  0.9997857296  0.9939991427  0.9995714592  0.9965709387  0.9988213865  0.9909987141  0.9990356798  0.9927132447  3600.0000000  -23.12224536  -23.15154413  3600          6.5405060554 
0.9730019284  0.9665666524  0.9995714592  0.9897128161  0.9997857296  0.9931418774  0.9995714592  0.9952850407  0.9988213865  0.9901414488  0.9990356798  0.9931418774  3700.0000000  -23.11971679  -23.13736932  3700          5.9450288105 
0.9711806300  0.9674239177  0.9993571888  0.9888555508  0.9997857296  0.9944277754  0.9995714592  0.9957136734  0.9988213865  0.9901414488  0.9991428265  0.9922846121  3800.0000000  -23.11516757  -23.14815248  3800          5.7070547652 
0.9722519820  0.9669952850  0.9995714592  0.9892841835  0.9997857296  0.9944277754  0.9995714592  0.9961423060  0.9988213865  0.9905700814  0.9991428265  0.9914273468  3900.0000000  -23.12879673  -23.16684583  3900          6.3787259007 
0.9735376045  0.9699957137  0.9994643240  0.9888555508  0.9997857296  0.9935705101  0.9995714592  0.9961423060  0.9988213865  0.9914273468  0.9991428265  0.9914273468  4000.0000000  -23.12602748  -23.15919322  4000          6.1475974727 
saved at step 4100
0.9716091708  0.9678525504  0.9995714592  0.9909987141  0.9997857296  0.9939991427  0.9995714592  0.9965709387  0.9988213865  0.9905700814  0.9991428265  0.9927132447  4100.0000000  -23.13060644  -23.16010419  4100          5.8469371748 
0.9726805228  0.9669952850  0.9995714592  0.9892841835  0.9997857296  0.9939991427  0.9995714592  0.9961423060  0.9988213865  0.9918559794  0.9992499732  0.9931418774  4200.0000000  -23.14195072  -23.16920652  4200          5.9364551497 
0.9730019284  0.9682811830  0.9993571888  0.9888555508  0.9997857296  0.9939991427  0.9995714592  0.9965709387  0.9989285332  0.9909987141  0.9992499732  0.9914273468  4300.0000000  -23.14469152  -23.15648233  4300          5.9970081258 
0.9726805228  0.9678525504  0.9996785944  0.9892841835  0.9997857296  0.9944277754  0.9995714592  0.9952850407  0.9988213865  0.9909987141  0.9992499732  0.9918559794  4400.0000000  -23.14325395  -23.17028497  4400          5.8219393635 
0.9722519820  0.9674239177  0.9997857296  0.9901414488  0.9997857296  0.9939991427  0.9995714592  0.9961423060  0.9988213865  0.9897128161  0.9992499732  0.9922846121  4500.0000000  -23.14173763  -23.16870645  4500          5.9195164824 
0.9727876580  0.9678525504  0.9996785944  0.9888555508  0.9997857296  0.9944277754  0.9995714592  0.9965709387  0.9988213865  0.9909987141  0.9992499732  0.9918559794  4600.0000000  -23.18993360  -23.21850133  4600          5.8649174309 
0.9721448468  0.9691384483  0.9995714592  0.9892841835  0.9997857296  0.9935705101  0.9995714592  0.9957136734  0.9988213865  0.9905700814  0.9992499732  0.9922846121  4700.0000000  -23.20479026  -23.22916923  4700          5.6535820985 
0.9721448468  0.9682811830  0.9997857296  0.9888555508  0.9997857296  0.9944277754  0.9995714592  0.9961423060  0.9988213865  0.9909987141  0.9992499732  0.9914273468  4800.0000000  -23.20182945  -23.23104545  4800          5.8517819524 
0.9724662524  0.9687098157  0.9996785944  0.9892841835  0.9997857296  0.9944277754  0.9995714592  0.9965709387  0.9988213865  0.9909987141  0.9992499732  0.9918559794  4900.0000000  -23.20944097  -23.23439706  4900          6.0843322873 
0.9713949004  0.9682811830  0.9995714592  0.9892841835  0.9997857296  0.9944277754  0.9995714592  0.9961423060  0.9988213865  0.9914273468  0.9992499732  0.9922846121  5000.0000000  -23.20456937  -23.22980070  5000          4.8519229960 
0.9718234412  0.9699957137  0.9997857296  0.9897128161  0.9997857296  0.9935705101  0.9995714592  0.9961423060  0.9989285332  0.9914273468  0.9992499732  0.9918559794  5100.0000000  -23.19865659  -23.21723337  5100          3.7187636995 
0.9731090636  0.9682811830  0.9996785944  0.9897128161  0.9997857296  0.9935705101  0.9995714592  0.9969995714  0.9990356798  0.9905700814  0.9992499732  0.9918559794  5200.0000000  -23.19770305  -23.22819623  5200          4.4084890270 
0.9723591172  0.9674239177  0.9996785944  0.9892841835  0.9997857296  0.9939991427  0.9996785944  0.9965709387  0.9990356798  0.9905700814  0.9992499732  0.9922846121  5300.0000000  -23.21410694  -23.23604387  5300          4.4337468410 
0.9721448468  0.9678525504  0.9997857296  0.9888555508  0.9997857296  0.9944277754  0.9996785944  0.9965709387  0.9990356798  0.9914273468  0.9992499732  0.9918559794  5400.0000000  -23.21595222  -23.24349536  5400          4.2651252460 
0.9735376045  0.9695670810  0.9996785944  0.9888555508  0.9997857296  0.9939991427  0.9995714592  0.9961423060  0.9989285332  0.9905700814  0.9992499732  0.9918559794  5500.0000000  -23.20821550  -23.22640136  5500          4.2184151888 
0.9745018213  0.9699957137  0.9997857296  0.9901414488  0.9997857296  0.9935705101  0.9996785944  0.9961423060  0.9988213865  0.9901414488  0.9992499732  0.9918559794  5600.0000000  -23.21010498  -23.23386001  5600          4.2252476525 
0.9736447397  0.9687098157  0.9996785944  0.9892841835  0.9997857296  0.9935705101  0.9996785944  0.9969995714  0.9989285332  0.9918559794  0.9992499732  0.9922846121  5700.0000000  -23.21616134  -23.23169467  5700          4.3078519654 
0.9716091708  0.9678525504  0.9995714592  0.9888555508  0.9997857296  0.9935705101  0.9996785944  0.9957136734  0.9990356798  0.9905700814  0.9992499732  0.9927132447  5800.0000000  -23.21579141  -23.23547416  5800          4.2171391439 
0.9726805228  0.9674239177  0.9998928648  0.9897128161  0.9997857296  0.9935705101  0.9996785944  0.9969995714  0.9990356798  0.9909987141  0.9992499732  0.9918559794  5900.0000000  -23.22008472  -23.24644546  5900          4.2709752917 
0.9722519820  0.9691384483  0.9998928648  0.9892841835  0.9997857296  0.9944277754  0.9996785944  0.9961423060  0.9989285332  0.9909987141  0.9992499732  0.9909987141  6000.0000000  -23.22943540  -23.24744178  6000          4.3760913539 
0.9724662524  0.9682811830  0.9996785944  0.9892841835  0.9997857296  0.9935705101  0.9996785944  0.9969995714  0.9990356798  0.9905700814  0.9992499732  0.9918559794  6100.0000000  -23.25505815  -23.27544929  6100          4.3557823086 
0.9725733876  0.9682811830  0.9997857296  0.9897128161  0.9997857296  0.9931418774  0.9996785944  0.9961423060  0.9990356798  0.9901414488  0.9992499732  0.9922846121  6200.0000000  -23.25311597  -23.27168844  6200          4.3725605702 
0.9725733876  0.9687098157  0.9998928648  0.9892841835  0.9997857296  0.9931418774  0.9996785944  0.9957136734  0.9990356798  0.9905700814  0.9992499732  0.9914273468  6300.0000000  -23.24115743  -23.26359403  6300          4.2813721395 
0.9726805228  0.9691384483  0.9997857296  0.9888555508  0.9997857296  0.9931418774  0.9996785944  0.9961423060  0.9989285332  0.9909987141  0.9992499732  0.9922846121  6400.0000000  -23.25008823  -23.27976856  6400          4.2634981370 
0.9725733876  0.9695670810  0.9996785944  0.9892841835  0.9997857296  0.9939991427  0.9996785944  0.9961423060  0.9989285332  0.9905700814  0.9992499732  0.9922846121  6500.0000000  -23.25015048  -23.27136211  6500          4.3371996474 
